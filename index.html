<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Js-routes by railsware</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Js-routes</h1>
        <p class="header">Brings Rails named routes to javascript</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/railsware/js-routes/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/railsware/js-routes/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/railsware/js-routes">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/railsware">railsware</a></p>


      </header>
      <section>
        <h1>
<a name="jsroutes" class="anchor" href="#jsroutes"><span class="octicon octicon-link"></span></a>JsRoutes</h1>

<p><a href="https://travis-ci.org/railsware/js-routes"><img src="https://travis-ci.org/railsware/js-routes.png" alt="Build Status"></a></p>

<p>Generates javascript file that defines all Rails named routes as javascript helpers</p>

<h2>
<a name="intallation" class="anchor" href="#intallation"><span class="octicon octicon-link"></span></a>Intallation</h2>

<p>Your Rails Gemfile:</p>

<div class="highlight highlight-ruby"><pre><span class="n">gem</span> <span class="s2">"js-routes"</span>
</pre></div>

<h3>
<a name="basic-setup-asset-pipeline" class="anchor" href="#basic-setup-asset-pipeline"><span class="octicon octicon-link"></span></a>Basic Setup (Asset Pipeline)</h3>

<p>Require js routes file in <code>application.js</code> or other bundle</p>

<div class="highlight highlight-js"><pre><span class="cm">/*</span>
<span class="cm">= require js-routes</span>
<span class="cm">*/</span>
</pre></div>

<p>Also in order to flush asset pipeline cache sometimes you might need to run:</p>

<div class="highlight highlight-sh"><pre>rake tmp:cache:clear
</pre></div>

<p>This cache is not flushed on server restart in development environment.</p>

<p><strong>Important:</strong> If routes.js file is not updated after some configuration change you need to run this rake task again.</p>

<h3>
<a name="advanced-setup" class="anchor" href="#advanced-setup"><span class="octicon octicon-link"></span></a>Advanced Setup</h3>

<p>If you need to customize routes file create initializer, like <code>config/initializers/jsroutes.rb</code>:</p>

<div class="highlight highlight-ruby"><pre><span class="no">JsRoutes</span><span class="o">.</span><span class="n">setup</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="o">.</span><span class="n">option</span> <span class="o">=</span> <span class="n">value</span>
<span class="k">end</span>
</pre></div>

<p>Available options:</p>

<ul>
<li>
<code>default_url_options</code> - default parameters to be used to generate url

<ul>
<li>Note that currently only optional parameters (like <code>:format</code> or <code>:trailing_slash</code>) can be defaulted.</li>
<li>Example: {:format =&gt; "json", :trailing_slash =&gt; true}</li>
<li>Default: {}</li>
</ul>
</li>
<li>
<code>exclude</code> - Array of regexps to exclude from js routes.

<ul>
<li>Default: []</li>
<li>The regexp applies only to the name before the <code>_path</code> suffix, eg: you want to match exactly <code>settings_path</code>, the regexp should be <code>/^settings$/</code>
</li>
</ul>
</li>
<li>
<code>include</code> - Array of regexps to include in js routes.

<ul>
<li>Default: []</li>
<li>The regexp applies only to the name before the <code>_path</code> suffix, eg: you want to match exactly <code>settings_path</code>, the regexp should be <code>/^settings$/</code>
</li>
</ul>
</li>
<li>
<code>namespace</code> - global object used to access routes.

<ul>
<li>Supports nested namespace like <code>MyProject.routes</code>
</li>
<li>Default: <code>Routes</code>
</li>
</ul>
</li>
<li>
<code>prefix</code> - String representing a url path to prepend to all paths.

<ul>
<li>Example: <code>http://yourdomain.com</code>. This will cause route helpers to generate full path only.</li>
<li>Default: blank</li>
</ul>
</li>
<li>
<code>camel_case</code> (version &gt;= 0.8.8) - Generate camel case route names.

<ul>
<li>Default: false</li>
</ul>
</li>
<li>
<code>url_links</code> (version &gt;= 0.8.9) - Generate <code>*_url</code> links (in addition to default <code>*_path</code>), where url_links value is beginning of url routes

<ul>
<li>Example: http[s]://example.com</li>
<li>Default: false</li>
</ul>
</li>
</ul><h3>
<a name="very-advanced-setup" class="anchor" href="#very-advanced-setup"><span class="octicon octicon-link"></span></a>Very Advanced Setup</h3>

<p>In case you need multiple route files for different parts of your application, you have to create the files manually.
If your application has an <code>admin</code> and an <code>application</code> namespace for example:</p>

<pre><code># app/assets/javascripts/admin/routes.js.erb
&lt;%= JsRoutes.generate(namespace: "AdminRoutes", include: /admin/) %&gt;

# app/assets/javascripts/admin.js.coffee
#= require admin/routes
</code></pre>

<pre><code># app/assets/javascripts/application/routes.js.erb
&lt;%= JsRoutes.generate(namespace: "AppRoutes", exclude: /admin/) %&gt;

# app/assets/javascripts/application.js.coffee
#= require application/routes
</code></pre>

<p>In order to generate the routes to a string:</p>

<div class="highlight highlight-ruby"><pre><span class="n">routes_js</span> <span class="o">=</span> <span class="no">JsRoutes</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
</pre></div>

<p>If you want to generate the routes files outside of the asset pipeline, you can use <code>JsRoutes.generate!</code>:</p>

<div class="highlight highlight-ruby"><pre><span class="n">path</span> <span class="o">=</span> <span class="s2">"app/assets/javascripts"</span>
<span class="no">JsRoutes</span><span class="o">.</span><span class="n">generate!</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">/app_routes.js"</span><span class="p">,</span> <span class="ss">:namespace</span> <span class="o">=&gt;</span> <span class="s2">"AppRoutes"</span><span class="p">,</span> <span class="ss">:exclude</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="sr">/^admin_/</span><span class="p">,</span> <span class="sr">/^api_/</span><span class="o">]</span><span class="p">)</span>
<span class="no">JsRoutes</span><span class="o">.</span><span class="n">generate!</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">/adm_routes.js"</span><span class="p">,</span> <span class="ss">:namespace</span> <span class="o">=&gt;</span> <span class="s2">"AdmRoutes"</span><span class="p">,</span> <span class="ss">:include</span> <span class="o">=&gt;</span> <span class="sr">/^admin_/</span><span class="p">)</span>
<span class="no">JsRoutes</span><span class="o">.</span><span class="n">generate!</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">/api_routes.js"</span><span class="p">,</span> <span class="ss">:namespace</span> <span class="o">=&gt;</span> <span class="s2">"ApiRoutes"</span><span class="p">,</span> <span class="ss">:include</span> <span class="o">=&gt;</span> <span class="sr">/^api_/</span><span class="p">,</span> <span class="ss">:default_url_options</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="ss">:format</span> <span class="o">=&gt;</span> <span class="s2">"json"</span><span class="p">})</span>
</pre></div>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>Configuration above will create a nice javascript file with <code>Routes</code> object that has all the rails routes available:</p>

<div class="highlight highlight-js"><pre><span class="nx">Routes</span><span class="p">.</span><span class="nx">users_path</span><span class="p">()</span> <span class="c1">// =&gt; "/users"</span>
<span class="nx">Routes</span><span class="p">.</span><span class="nx">user_path</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">// =&gt; "/users/1"</span>
<span class="nx">Routes</span><span class="p">.</span><span class="nx">user_path</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="nx">format</span><span class="o">:</span> <span class="s1">'json'</span><span class="p">})</span> <span class="c1">// =&gt; "/users/1.json"</span>
<span class="nx">Routes</span><span class="p">.</span><span class="nx">new_user_project_path</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="nx">format</span><span class="o">:</span> <span class="s1">'json'</span><span class="p">})</span> <span class="c1">// =&gt; "/users/1/projects/new.json"</span>
<span class="nx">Routes</span><span class="p">.</span><span class="nx">user_project_path</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">{</span><span class="nx">q</span><span class="o">:</span> <span class="s1">'hello'</span><span class="p">,</span> <span class="nx">custom</span><span class="o">:</span> <span class="kc">true</span><span class="p">})</span> <span class="c1">// =&gt; "/users/1/projects/2?q=hello&amp;custom=true"</span>
<span class="nx">Routes</span><span class="p">.</span><span class="nx">user_project_path</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">{</span><span class="nx">hello</span><span class="o">:</span> <span class="p">[</span><span class="s1">'world'</span><span class="p">,</span> <span class="s1">'mars'</span><span class="p">]})</span> <span class="c1">// =&gt; "/users/1/projects/2?hello%5B%5D=world&amp;hello%5B%5D=mars"</span>
</pre></div>

<p>Using serialized object as route function arguments:</p>

<div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">google</span> <span class="o">=</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Google"</span><span class="p">};</span>
<span class="nx">Routes</span><span class="p">.</span><span class="nx">company_path</span><span class="p">(</span><span class="nx">google</span><span class="p">)</span> <span class="c1">// =&gt; "/companies/1"</span>
<span class="kd">var</span> <span class="nx">google</span> <span class="o">=</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Google"</span><span class="p">,</span> <span class="nx">to_param</span><span class="o">:</span> <span class="s2">"google"</span><span class="p">};</span>
<span class="nx">Routes</span><span class="p">.</span><span class="nx">company_path</span><span class="p">(</span><span class="nx">google</span><span class="p">)</span> <span class="c1">// =&gt; "/companies/google"</span>
</pre></div>

<p>In order to make routes helpers available globally:</p>

<div class="highlight highlight-js"><pre><span class="nx">jQuery</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nb">window</span><span class="p">,</span> <span class="nx">Routes</span><span class="p">)</span>
</pre></div>

<h2>
<a name="what-about-security" class="anchor" href="#what-about-security"><span class="octicon octicon-link"></span></a>What about security?</h2>

<p>js-routes itself do not have security holes. It makes URLs
without access protection more reachable by potential attacker.
In order to prevent this use <code>:exclude</code> option for sensitive urls like <code>/admin_/</code></p>

<h2>
<a name="spork" class="anchor" href="#spork"><span class="octicon octicon-link"></span></a>Spork</h2>

<p>When using Spork and <code>Spork.trap_method(Rails::Application::RoutesReloader, :reload!)</code> you should also do:</p>

<div class="highlight highlight-ruby"><pre><span class="no">Spork</span><span class="o">.</span><span class="n">trap_method</span><span class="p">(</span><span class="no">JsRoutes</span><span class="p">,</span> <span class="ss">:generate!</span><span class="p">)</span>
</pre></div>

<h2>
<a name="advantages-over-alternatives" class="anchor" href="#advantages-over-alternatives"><span class="octicon octicon-link"></span></a>Advantages over alternatives</h2>

<p>There are some alternatives available. Most of them has only basic feature and don't reach the level of quality I accept.
Advantages of this one are:</p>

<ul>
<li>Rails3 &amp; Rails4 support</li>
<li>Rich options set</li>
<li>Support Rails <code>#to_param</code> convention for seo optimized paths</li>
<li>Well tested</li>
</ul><h4>
<a name="thanks-to-contributors" class="anchor" href="#thanks-to-contributors"><span class="octicon octicon-link"></span></a>Thanks to <a href="https://github.com/railsware/js-routes/contributors">Contributors</a>
</h4>

<h4>
<a name="have-fun" class="anchor" href="#have-fun"><span class="octicon octicon-link"></span></a>Have fun</h4>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
